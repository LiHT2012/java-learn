1. 遵循“两顶帽子”重构原则


在重构时，两个不同的操作分开进行：重构代码和新增功能。


先在不改变原系统功能的基础上修改现有代码的设计，这样采用原有的测试方法可以轻松地验证这些修改的正确性。


再在已重构好的基础上增加新功能，使得新功能与老功能合理解耦。


上述例子里，业务组边重构边在上面新开发功能，给测试人员的压力巨大，原有的测试方法全不适用，增加回归测试工作量。


2. 使用“小步快跑”的重构策略


重构避免使用“大布局”规划项目进程，如果从整理需求、设计接口、开发联调、测试上线，经历几个月的时间，如果其间有问题，整个团队又得人仰马翻地去调整方向，试错成本过高。


“小布快跑”是让我们重构时只关注一个问题点，只解决这一个问题。小改动，小局部优化，耗时短，见效快。


这便需要我们将重构当作一个习惯，融入在每一次代码修改中。


3. 测试驱动开发


上文例子里将代码的质量保证全丢给测试人员，光是对整个系统接口的性能测试就耗费大半个月的时间，等测试人员将问题列表整理后又得重新改代码，不单浪费时间，还可能引入大风险。


正确的重构姿势是将测试融入在每一次重构中，小步快跑，修改一块代码便自测这块，等调通后再继续往下走。重构有风险，开发测试两手捉。
